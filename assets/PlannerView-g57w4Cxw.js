import{c as w,r as p,j as e,B as h,t as N,d as v}from"./index-Bwl7mqWd.js";import{D as k,a as D,b as C,c as I,e as L,P as A}from"./dialog-BGHabCDb.js";import{I as S}from"./index-DREhc0oo.js";import{L as j}from"./label-Bzd58kTZ.js";import{S as E,a as F,b as M,c as O,d as P}from"./select-DVwqJ33R.js";import{u as y}from"./dexie-react-hooks-I5uuTxWo.js";import{C as $,a as q}from"./chevron-right-Dz8YJqg4.js";import"./index-BdQq_4o_.js";import"./index-D5KKpL3l.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=w("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);function B({isOpen:g,onClose:x,date:n}){const[l,c]=p.useState(""),[d,o]=p.useState("09:00"),[m,t]=p.useState("10:00"),[a,i]=p.useState(void 0),r=y(()=>{const s=new Date(n);s.setHours(0,0,0,0);const f=new Date(n);return f.setHours(23,59,59,999),v.tasks.where("date").between(s,f,!0,!0).toArray()},[n]),u=()=>{c(""),o("09:00"),t("10:00"),i(void 0)},T=async()=>{if(!l||!d||!m){N({title:"Error",description:"Please fill in all time slot details.",variant:"destructive"});return}try{await v.timeSlots.add({title:l,startTime:d,endTime:m,date:n,taskId:a,createdAt:new Date}),N({title:"Success",description:"Time slot created."}),u(),x()}catch(s){console.error("Failed to save time slot:",s),N({title:"Error",description:"Failed to save time slot.",variant:"destructive"})}},b=s=>{s||(u(),x())};return e.jsx(k,{open:g,onOpenChange:b,children:e.jsxs(D,{children:[e.jsx(C,{children:e.jsx(I,{children:"Add Time Slot"})}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(j,{htmlFor:"title",className:"text-right",children:"Title"}),e.jsx(S,{id:"title",value:l,onChange:s=>c(s.target.value),className:"col-span-3"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(j,{htmlFor:"startTime",className:"text-right",children:"Start Time"}),e.jsx(S,{id:"startTime",type:"time",value:d,onChange:s=>o(s.target.value),className:"col-span-3"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(j,{htmlFor:"endTime",className:"text-right",children:"End Time"}),e.jsx(S,{id:"endTime",type:"time",value:m,onChange:s=>t(s.target.value),className:"col-span-3"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(j,{htmlFor:"task",className:"text-right",children:"Link Task"}),e.jsxs(E,{onValueChange:s=>i(Number(s)),value:a==null?void 0:a.toString(),children:[e.jsx(F,{className:"col-span-3",children:e.jsx(M,{placeholder:"(Optional) Select a task"})}),e.jsx(O,{children:r==null?void 0:r.map(s=>e.jsx(P,{value:s.id.toString(),children:s.title},s.id))})]})]})]}),e.jsxs(L,{children:[e.jsx(h,{variant:"outline",onClick:x,children:"Cancel"}),e.jsx(h,{onClick:T,children:"Save"})]})]})})}const X=()=>{const[g,x]=p.useState(new Date),[n,l]=p.useState(!1),c=g.toISOString().slice(0,10),d=t=>{x(a=>{const i=new Date(a);return i.setDate(i.getDate()+(t==="next"?1:-1)),i})},o=y(async()=>{const t=await v.timeSlots.where("date").equals(c).sortBy("startTime"),a=await v.tasks.toArray(),i=new Map(a.map(r=>[r.id,r]));return t.map(r=>({...r,task:r.taskId?i.get(r.taskId):void 0}))},[c]),m=Array.from({length:24},(t,a)=>a);return e.jsxs("div",{className:"p-4 md:p-6",children:[e.jsxs("header",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold bg-gradient-zenith bg-clip-text text-transparent",children:"Daily Time Planner"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{variant:"outline",size:"icon",onClick:()=>d("prev"),children:e.jsx($,{className:"h-4 w-4"})}),e.jsx("span",{className:"text-lg font-semibold w-48 text-center",children:g.toLocaleDateString("default",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),e.jsx(h,{variant:"outline",size:"icon",onClick:()=>d("next"),children:e.jsx(q,{className:"h-4 w-4"})})]}),e.jsxs(h,{onClick:()=>l(!0),children:[e.jsx(A,{className:"mr-2 h-4 w-4"})," Add Time Slot"]})]}),e.jsxs("div",{className:"relative grid grid-cols-[auto_1fr] gap-x-4",children:[m.map(t=>e.jsx("div",{className:"relative text-right -top-3",children:e.jsx("span",{className:"text-sm text-muted-foreground",children:`${t.toString().padStart(2,"0")}:00`})},t)),e.jsx("div",{className:"col-start-2 grid grid-rows-24 border-l border-border",children:m.map(t=>e.jsx("div",{className:"h-16 border-t border-border -ml-4 pl-4"},t))}),e.jsx("div",{className:"col-start-2 row-start-1 relative",children:o==null?void 0:o.map(t=>{const a=parseInt(t.startTime.split(":")[0])*60+parseInt(t.startTime.split(":")[1]),i=parseInt(t.endTime.split(":")[0])*60+parseInt(t.endTime.split(":")[1]),r=a/60*64,u=(i-a)/60*64;return e.jsxs("div",{className:"absolute w-full p-2 rounded-lg bg-primary/20 border border-primary/50 text-primary-foreground overflow-hidden",style:{top:`${r}px`,height:`${u}px`},children:[e.jsx("p",{className:"font-bold text-sm truncate",children:t.title}),e.jsx("p",{className:"text-xs text-primary/80",children:`${t.startTime} - ${t.endTime}`}),t.task&&e.jsxs("div",{className:"flex items-center gap-1.5 mt-1 pt-1 border-t border-primary/20",children:[e.jsx(z,{className:"h-3 w-3 text-primary/80"}),e.jsx("p",{className:"text-xs font-medium text-primary/90 truncate",children:t.task.title})]})]},t.id)})})]}),e.jsx(B,{isOpen:n,onClose:()=>l(!1),date:c})]})};export{X as default};
